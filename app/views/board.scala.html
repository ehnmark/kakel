@(id: Long, playerId: String)(implicit request: RequestHeader)

@main("Game %d (%s)".format(id, playerId)) {
	
	<p class="lead" id="status"></p>

	<hr class="clear: left"/>

	<ul id="board" data-bind="foreach: pieces">
		<li>
			<div data-bind="text: display, click: $root.toggleSelected, css: pieceStyle"></div>
		</li>
	</ul>

	<hr/>

	<ul data-bind="foreach: selected">
		<li>
			<div data-bind="text: display, click: $root.toggleSelected, css: pieceStyle"></div>
		</li>
	</ul>

	<hr/>

	<button class="btn btn-primary" data-bind="click: submitMove, enabled: canSubmitMove, visible: isMyTurn">Submit move</button>

	<h6><a id="oplink" href="">Opponent link</a></h6>


	<script src="@routes.Assets.at("javascripts/board.knockout.js")" type="text/javascript"></script>
	<script>
		createViewModel(@id, "@playerId");
	</script>

	<script type="text/javascript">
		var connection = new WebSocket('@routes.Game.subscribeWS(id, playerId).webSocketURL()');
		connection.onopen = function () {
			console.log("WS onopen");
		};

		connection.onerror = function (error) {
			console.log('WS onerror: ' + error);
		};

		connection.onmessage = function (e) {
			console.log('WS onmessage: ' + e.data);
			viewModel.reload();
		};
	</script>
}